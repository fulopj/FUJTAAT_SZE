<!DOCTYPE html>

<html>
    <head>
        <title>Törlés</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="css/headers.css" rel="stylesheet" type="text/css">
        <link href="css/drawer.css" rel="stylesheet" type="text/css">
        <link href="css/app.css" rel="stylesheet" type="text/css">
        <link href="css/layout.css" rel="stylesheet" type="text/css"/>
        <link href="css/input_areas.css" rel="stylesheet" type="text/css">
        <link href="css/switches.css" rel="stylesheet" type="text/css">
        <link href="css/lists.css" rel="stylesheet" type="text/css">
        <link href="css/buttons.css" rel="stylesheet" type="text/css">
        <link href="css/toolbars.css" rel="stylesheet" type="text/css">
        <script src="jquery-1.11.2.min.js" type="text/javascript"></script>
    </head>
    
    <body>
        <div>
            <section data-type="sidebar">
                <header>
                    <h1>Menü</h1>
                </header>
                <nav>
                    <ul>
                        <li><a href="index.html">Pénztárca</a></li>
                        <li><a href="hol_hozzaadasa.html">Hol-ok Karbantartása</a></li>
                        <li><a href="kilepes.html">Kilépés</a></li>
                    </ul>
                </nav>
            </section>

            <section id="drawer" role="region">
                <header>
                    <a href="#content"><span class="icon icon-menu">hide sidebar</span></a>
                    <a href="#drawer"><span class="icon icon-menu">show sidebar</span></a>
                    <h1>Hol törlése</h1>
                </header>
                <div role="main">
                    <section class="gaia-list fit scroll sticky">
                        <article>
                            <form onsubmit="return false;" style="height: 700px">
                                <label>Hol azonosítója (amelyiket törölni szeretnénk) </label><br />
                                <input type="text" id="hol_azonosito" />
                                <button class="danger" id="btnTorol">Töröl</button>
                            </form>
                        </article>
                    </section>
                </div>
            </section>
        </div>
        
        <script type="text/javascript">
            var db;
            var indexedDB = window.indexedDB;

            (function () {
                function initDb() {
                    var request = indexedDB.open("penz_adattar", 2);
                    request.onsuccess = function (evt) {
                        db = request.result;
                       // window.alert (db.toString());
                    };
                    
                    request.onerror = function (evt) {
                        console.log("IndexedDB Hiba: " + evt.target.errorCode);
                    };
                    
                    request.onupgradeneeded = function (evt) {
                        var objectStore = evt.currentTarget.result.createObjectStore(
                                "tranzakciok", {keyPath: "id", autoIncrement: true});
                        objectStore.createIndex("datum", "datum", {unique: false});
                        
                        objectStore_Hol = evt.currentTarget.result.createObjectStore(
                                "hol_ok", {keyPath: "id", autoIncrement: true});
                        
                    };
                }
                
                initDb();
                
                function contentLoaded() {
                    var btnTorol = document.getElementById("btnTorol");
                    btnTorol.addEventListener("click", function () {
                        var akt_hol = document.getElementById("hol_azonosito").value;
                        
                        var transaction = db.transaction("hol_ok", "readwrite");
                        var objectStore = transaction.objectStore("hol_ok");
                        
                        var request = objectStore.delete(parseInt (akt_hol));
                        request.onsuccess = function (evt) {
                            //window.alert("Sikeres:");
                            
                        };
                        
                        request.onerror = function (evt) {
                            //window.alert("Sikertelen");
                        };
                        
                        transaction.oncomplete = function (evt) {
                            window.location = "hol_hozzaadasa.html";
                        };
                        
                    }, false);


                }

                window.addEventListener("DOMContentLoaded", contentLoaded, false);
            }

            ) ();
                    //document.getElementById("Megtekint").addEventListener("click", initDb);
        </script>
    </body>
</html>
